import"./wallet-connection-ab619167.js";import"./user-store-1040f6a5.js";import"./image-handler-91d970e9.js";class e{constructor(e){this.wallet=e,this.isEditing=!1,this.userProfile={},this.init()}init(){document.addEventListener("DOMContentLoaded",()=>{this.setupEventListeners(),this.checkInitialWalletState()}),void 0!==window.ethereum&&window.ethereum.on("accountsChanged",e=>{this.handleAccountsChanged(e)})}checkInitialWalletState(){this.wallet&&this.wallet.state.isConnected&&this.wallet.state.address?this.handleAccountsChanged([this.wallet.state.address]):void 0!==window.ethereum?window.ethereum.request({method:"eth_accounts"}).then(e=>this.handleAccountsChanged(e)).catch(e=>{console.error("Error checking wallet connection:",e),this.showWelcomeSection()}):this.showWelcomeSection()}setupEventListeners(){const e=document.getElementById("editProfileBtn"),t=document.getElementById("saveProfileBtn"),i=document.getElementById("cancelEditBtn");e&&e.addEventListener("click",()=>this.toggleEditMode()),t&&t.addEventListener("click",()=>this.saveProfile()),i&&i.addEventListener("click",()=>this.cancelEdit());const s=document.getElementById("mobileMenuToggle"),n=document.getElementById("mobileMenu");s&&n&&s.addEventListener("click",()=>{n.classList.toggle("active")})}handleAccountsChanged(e){e.length>0?(this.loadUserProfile(e[0]),this.showProfileContent(),this.loadUserNFTs(e[0]),this.loadUserActivity(e[0])):this.showWelcomeSection()}loadUserProfile(e){this.updateUserDisplay(e);const t=localStorage.getItem(`profile_${e}`);if(t)try{this.userProfile=JSON.parse(t),this.populateProfileForm()}catch(i){console.error("Error parsing saved profile:",i),this.userProfile={}}else this.userProfile={}}updateUserDisplay(e){const t=document.getElementById("userName"),i=document.getElementById("userAddressDisplay"),s=document.getElementById("userInitials");t&&(t.textContent=this.userProfile.artistName||`${e.slice(0,6)}...${e.slice(-4)}`),i&&(i.textContent=e),s&&(s.textContent=this.userProfile.artistName?this.userProfile.artistName.charAt(0).toUpperCase():e.charAt(2).toUpperCase())}showWelcomeSection(){const e=document.getElementById("welcomeSection"),t=document.getElementById("profileContent");e&&(e.style.display="block"),t&&(t.style.display="none")}showProfileContent(){const e=document.getElementById("welcomeSection"),t=document.getElementById("profileContent");e&&(e.style.display="none"),t&&(t.style.display="grid")}toggleEditMode(){this.isEditing=!this.isEditing;const e=document.getElementById("artistProfileForm"),t=document.getElementById("editProfileBtn"),i=document.getElementById("saveProfileBtn"),s=document.getElementById("cancelEditBtn");e&&(e.style.display=this.isEditing?"block":"none"),t&&(t.style.display=this.isEditing?"none":"block"),i&&(i.style.display=this.isEditing?"block":"none"),s&&(s.style.display=this.isEditing?"block":"none"),this.isEditing&&this.populateProfileForm()}cancelEdit(){this.isEditing=!1;const e=document.getElementById("artistProfileForm"),t=document.getElementById("editProfileBtn"),i=document.getElementById("saveProfileBtn"),s=document.getElementById("cancelEditBtn");e&&(e.style.display="none"),t&&(t.style.display="block"),i&&(i.style.display="none"),s&&(s.style.display="none"),this.populateProfileForm()}populateProfileForm(){["artistName","artistBio","artistWebsite","artistSocial","artistEmail","artistLocation"].forEach(e=>{const t=document.getElementById(e);t&&(t.value=this.userProfile[e]||"")})}sanitizeInput(e){if(!e)return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}saveProfile(){var e,t,i,s,n,o,l,a;const r=null==(t=null==(e=this.wallet)?void 0:e.state)?void 0:t.address;if(!r)return void this.showMessage("Please connect your wallet first.","error");const d={artistName:this.sanitizeInput(null==(i=document.getElementById("artistName"))?void 0:i.value),artistBio:this.sanitizeInput(null==(s=document.getElementById("artistBio"))?void 0:s.value),artistWebsite:this.sanitizeInput(null==(n=document.getElementById("artistWebsite"))?void 0:n.value),artistSocial:this.sanitizeInput(null==(o=document.getElementById("artistSocial"))?void 0:o.value),artistEmail:this.sanitizeInput(null==(l=document.getElementById("artistEmail"))?void 0:l.value),artistLocation:this.sanitizeInput(null==(a=document.getElementById("artistLocation"))?void 0:a.value)};if(d.artistName.trim())if(!d.artistEmail||this.isValidEmail(d.artistEmail))if(!d.artistWebsite||this.isValidURL(d.artistWebsite))try{localStorage.setItem(`profile_${r}`,JSON.stringify(d)),this.userProfile=d,this.updateUserDisplay(r),this.toggleEditMode(),this.showMessage("Profile saved successfully!","success")}catch(c){console.error("Error saving profile:",c),this.showMessage("Error saving profile. Please try again.","error")}else this.showMessage("Please enter a valid website URL.","error");else this.showMessage("Please enter a valid email address.","error");else this.showMessage("Artist name is required.","error")}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}isValidURL(e){try{return new URL(e),!0}catch{return!1}}loadUserNFTs(e){const t=JSON.parse(localStorage.getItem("userNFTs")||"[]").filter(t=>t.owner===e);this.displayNFTs(t),this.updateStats(e,t)}displayNFTs(e){const t=document.getElementById("userNFTGrid");t&&(0!==e.length?t.innerHTML=e.map(e=>`\n            <div class="nft-card" onclick="this.viewNFT('${e.id}')">\n                <div class="nft-image">\n                    ${e.image?`<img src="${e.image}" alt="${e.title}" style="width: 100%; height: 100%; object-fit: cover;">`:"ðŸŽ¨"}\n                </div>\n                <div class="nft-info">\n                    <div class="nft-name">${e.title}</div>\n                    <div class="nft-price">${e.price} ETH</div>\n                </div>\n            </div>\n        `).join(""):t.innerHTML='\n                <div class="empty-state">\n                    <h3>No NFTs Found</h3>\n                    <p>You don\'t own any NFTs yet. Explore the gallery to start your collection!</p>\n                    <a href="gallery.html" class="btn btn-primary">Browse Gallery</a>\n                </div>\n            ')}updateStats(e,t){const i=document.getElementById("nftCount");i&&(i.textContent=t.length);const s=JSON.parse(localStorage.getItem("createdNFTs")||"[]").filter(t=>t.creator===e),n=document.getElementById("createdCount");n&&(n.textContent=s.length);const o=document.getElementById("soldCount"),l=document.getElementById("totalEarnings");o&&(o.textContent="0"),l&&(l.textContent="0.0")}loadUserActivity(e){const t=document.getElementById("activityList");t&&(t.innerHTML='\n            <div class="empty-state">\n                <h3>No Activity Yet</h3>\n                <p>Your recent transactions and activities will appear here.</p>\n            </div>\n        ')}showMessage(e,t="info",i=5e3){document.querySelectorAll(".profile-message").forEach(e=>e.remove());const s=document.createElement("div");s.className=`message ${t}`,s.textContent=e,document.body.appendChild(s),setTimeout(()=>{s.remove()},i)}viewNFT(e){console.log("Viewing NFT:",e)}}"undefined"!=typeof window&&document.addEventListener("DOMContentLoaded",()=>{const t=()=>{window.wallet?new e(window.wallet):setTimeout(t,100)};t()});
